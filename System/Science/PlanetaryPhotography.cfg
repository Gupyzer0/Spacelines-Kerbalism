// ============================================================================
// PLanetary Photography Experiments
// ============================================================================

// ----------------------------------------------------------------------------
// Experiment Values
// ----------------------------------------------------------------------------

@KERBALISM_EXPERIMENT_VALUES:NEEDS[FeatureScience]
{
	%SPACELINES
	{
		Spacelines_Photos0{
			ECCost = 0.005
			size = 20
			value = 5
			duration = 600
			requirements = Sunlight
			ResourceRates = 
			CrewRequirement = 
		}

        Spacelines_Photos1{
			ECCost = 0.005
			size = 20
			value = 4
			duration = 7200
			requirements = Sunlight
			ResourceRates = 
			CrewRequirement = 
		}

        Spacelines_Photos2{
			ECCost = 0.125
			size = 50
			value = 16
			duration = 172800 // 2 days per biome
			requirements = OrbitMaxInclination:100,OrbitMaxEccentricity:0.035,AltitudeMax:220000
			ResourceRates = 
			CrewRequirement = 
		}

        Spacelines_Photos3{
			ECCost = 0.5
			size = 300
			value = 500
			duration = 157680000 // 5 years -> 10 years
			requirements = OrbitMinInclination:94.5,OrbitMaxInclination:97,OrbitMaxEccentricity:0.01
			ResourceRates = 
			CrewRequirement = 
		}

        Spacelines_Photos4{
			ECCost = 2.1
			size = 18720000 //Hubble sends an average of 18 GB of data per week
			value = 5000
			duration = 315360000 // 10 years -> 20 years
			requirements = OrbitMinInclination:70,OrbitMaxEccentricity:0.005,AltitudeMin:350000,RadiationMax:0.005
			ResourceRates = 
			CrewRequirement = 
		}
    }
}

// ----------------------------------------------------------------------------
// Science Definitions 
// ----------------------------------------------------------------------------

EXPERIMENT_DEFINITION
{
    id = Spacelines_Photos0
    title = Planetary Photography
    baseValue = 5
    scienceCap = 5
    dataScale = 20

    RESULTS
    {
        default = Photographs taken!
    }
    KERBALISM_EXPERIMENT
    {
		// sample mass in tons. if undefined or 0, the experiment produce a file
 	    SampleMass = 0.002
		// Body restrictions, multiple lines allowed (just don't use confictiong combinations).
	    BodyAllowed = HomeBody
		Situation = FlyingHigh@Biomes
		Situation = InSpaceLow@Biomes
    }
}

EXPERIMENT_DEFINITION
{
    id = Spacelines_Photos1
    title = Planetary photography with panoramic camera
    baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/value$
	dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/size$
	@dataScale /= #$baseValue$
    scienceCap = 5

    RESULTS
    {
        default = Photographs taken!
    }
    KERBALISM_EXPERIMENT
    {
		// sample mass in tons. if undefined or 0, the experiment produce a file
 	    SampleMass = 0.008
		// 80kgs total sample for 4x20kg launches, with 8kg for 10 biomes
		// Body restrictions, multiple lines allowed (just don't use confictiong combinations).
		Situation = InSpaceLow@Biomes
	    BodyAllowed = HomeBody
	    IncludeExperiment = Spacelines_Photos0
    }
}

EXPERIMENT_DEFINITION
{
    id = Spacelines_Photos2
    title = Photography with dual panoramic camera
    baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/value$
	dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/size$
	@dataScale /= #$baseValue$
    scienceCap = 16

    KERBALISM_EXPERIMENT
    {
 	    SampleMass = 0.032
		// the base kh-4 part gathers 40kg across 8 launches for a total of 320kg of film
	    BodyAllowed = HomeBody
		Situation = InSpaceLow@Biomes
	    IncludeExperiment = Spacelines_Photos1
    }
    RESULTS
    {
        default = Photographs taken!
    }
}

EXPERIMENT_DEFINITION
{
    id = Spacelines_Photos3
    title = Improved planetary photography with less than a meter of ground resolution
    baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/value$
	dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/size$
	@dataScale /= #$baseValue$
    scienceCap = 500

    RESULTS
    {
        default = Photographs taken!
    }
    KERBALISM_EXPERIMENT
    {
		// sample mass in tons. if undefined or 0, the experiment produce a file
 	    SampleMass = 2.5
		// Body restrictions, multiple lines allowed (just don't use confictiong combinations).
	    BodyAllowed = HomeBody
		Situation = InSpaceLow@Biomes
	    IncludeExperiment = Spacelines_Photos2
    }
}

EXPERIMENT_DEFINITION
{
    id = Spacelines_Photos4
    title = Planetary photography with less than half a meter resolution
    baseValue = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/value$
	dataScale = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/size$
	@dataScale /= #$baseValue$
    scienceCap = 5000

    RESULTS
    {
        default = Photographs taken!
    }
    KERBALISM_EXPERIMENT
    {
		// sample mass in tons. if undefined or 0, the experiment produce a file
 	    SampleMass = 0
		// Body restrictions, multiple lines allowed (just don't use confictiong combinations).
	    BodyAllowed = HomeBody
        Situation = InSpaceLow@Biomes
	    IncludeExperiment = Spacelines_Photos3
    }
}

// ----------------------------------------------------------------------------
// Replacing Experiments with our own experiment
// ----------------------------------------------------------------------------

// Tagging experiments

// Photos 0 - Early flown cameras in V-2 rockets
@PART[bluedog_cameraLowTech]:NEEDS[FeatureScience] {
    %Tag_Spacelines_Photos0 = True
}

// Photos 1 - KH-1 Early Orbital Photography
@PART[bluedog_Keyhole_Camera_KH1|bluedog_cameraMidTech]:NEEDS[FeatureScience] {
    %Tag_Spacelines_Photos1 = True
}

// Photos 2 - KH-4/Zenit Style Experiment
@PART[bluedog_Keyhole_Camera_KH4|bluedog_Keyhole_Camera_KH4B|bluedog_Gemini_LunarRecon_Camera]:NEEDS[FeatureScience] {
    %Tag_Spacelines_Photos2 = True
}

// Photos 3 - KH-7/8/9 Satellites | MOL
@PART[bluedog_Keyhole_Camera_KH7|bluedog_Keyhole_Camera_KH8|bluedog_Hexagon_Camera|bluedog_MOL_Camera]:NEEDS[FeatureScience] {
    %Tag_Spacelines_Photos3 = True
}

// Photos 4 - KH-11 Satellites
// @PART[]:NEEDS[FeatureScience] { -> Parts pending
//  %Spacelines_Photos4 = True
// }

// Setting Experiment Values
@PART[*]:HAS[#Tag_Spacelines_Photos0[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Photos0]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/ResourceRates$

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos0/size$
	}
}

@PART[*]:HAS[#Tag_Spacelines_Photos1[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Photos1]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/ResourceRates$

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos1/size$
	}
}

@PART[*]:HAS[#Tag_Spacelines_Photos2[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Photos2]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/ResourceRates$

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos2/size$
	}
}

@PART[*]:HAS[#Tag_Spacelines_Photos3[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Photos3]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/ResourceRates$

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos3/size$
	}
}

@PART[*]:HAS[#Tag_Spacelines_Photos4[True]]:NEEDS[FeatureScience] {
    @MODULE[Experiment]:HAS[#experiment_id[Spacelines_Photos4]] {
		%ec_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/ECCost$
		%crew_operate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/CrewRequirement$
		%requires = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/requirements$
		%data_rate = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/size$
		@data_rate /= #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/duration$
		%resources = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/ResourceRates$

		%experimentLength = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/duration$
		%experimentSize = #$@KERBALISM_EXPERIMENT_VALUES/SPACELINES/Spacelines_Photos4/size$
	}
}

// ----------------------------------------------------------------------------
// Animations
// ----------------------------------------------------------------------------

@PART[*]:HAS[#Tag_Spacelines_Photos0[True]],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}
@PART[*]:HAS[#Tag_Spacelines_Photos1[True]],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}
@PART[*]:HAS[#Tag_Spacelines_Photos2[True]],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}
@PART[*]:HAS[#Tag_Spacelines_Photos3[True]],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}
@PART[*]:HAS[#Tag_Spacelines_Photos4[True]],@MODULE:HAS[#animationName]]:NEEDS[FeatureScience]
{
	@MODULE[Experiment],*
	{
		%anim_deploy = #$../MODULE:HAS[#animationName,~name[Experiment]]/animationName$
	}
}